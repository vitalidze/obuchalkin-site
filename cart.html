---
layout: default
title: Корзина
---

<script src="js/spin.min.js" type="text/javascript"></script>
<script type="text/javascript">
    simpleCart({
        checkout: {
            type: "SendForm",
            url: "https://obuchalkin-backend.appspot.com/cart",
            success: "order-success.html",
            cancel: "order-failure.html"
        }
    });

    simpleCart({
        cartColumns: [
            { attr: "name" , label: "Набор" } ,
            { attr: "price" , label: "Цена", view: 'currency' } ,
            { view:'input', attr: "quantity" , label: "Кол-во" } ,
            { attr: "total" , label: "Подитог", view: 'currency' } ,
            { view: "remove" , text: "Убрать" , label: false }
        ],
        cartStyle: "table"
    });

    simpleCart.bind( 'beforeCheckout' , function( data ) {
        var name = document.getElementById("customer-name").value;
        var phone = document.getElementById("customer-phone").value;
        if (name.trim() == "" || phone.trim() == "") {
            alert("Поля \"Имя\" и \"Телефон\" обязательны для заполнения");
            return false;
        }

        data["customerName"] = name;
        data["customerPhone"] = phone;
        data["customerAddress"] = document.getElementById("customer-address").value;
        data["customerEmail"] = document.getElementById("customer-email").value;

        $.magnificPopup.open({
            showCloseBtn: false,
            items: {
                src: $('<div style="background: #ffffff; width: 240px; height: 80px; margin: 0 auto; padding: 10px;">' +
                        '<div style="text-align: center;">Ваш заказ обрабатывается...</div>' +
                        '<div id="order-processing-progress-monitor" style="padding-top: 35px; padding-left: 120px;"></div>' +
                        '</div>'),
                type: 'inline'
            }
        });

        var opts = {
            lines: 10, // The number of lines to draw
            length: 10, // The length of each line
            width: 6, // The line thickness
            radius: 10, // The radius of the inner circle
            corners: 1, // Corner roundness (0..1)
            rotate: 0, // The rotation offset
            direction: 1, // 1: clockwise, -1: counterclockwise
            color: '#000', // #rgb or #rrggbb or array of colors
            speed: 1, // Rounds per second
            trail: 60, // Afterglow percentage
            shadow: false, // Whether to render a shadow
            hwaccel: false, // Whether to use hardware acceleration
            className: 'spinner', // The CSS class to assign to the spinner
            zIndex: 2e9, // The z-index (defaults to 2000000000)
            top: 'auto', // Top position relative to parent in px
            left: 'auto' // Left position relative to parent in px
        };
        var target = document.getElementById('order-processing-progress-monitor');
        var spinner = new Spinner(opts).spin(target);
    });
</script>

<div class="content text-content">
    <div style="margin: 0px auto;">
        <h3 class="text">Корзина</h3>
        <div class="simpleCart_items"></div>
        <div style="margin-top: 10px;">Доставка: <div class="simpleCart_shipping"></div></div>
        <div style="margin-top: 10px;">Итого: <div class="simpleCart_grandTotal"></div></div>
        <h3 class="text">Контактные данные</h3>
        <table>
            <tr>
                <td class="label">Имя<span class="remark">*</span>:</td>
                <td class="value"><input id="customer-name" type="text" style="width: 300px;"></td>
            </tr>
            <tr>
                <td class="label">Телефон<span class="remark">*</span>:</td>
                <td class="value"><input id="customer-phone" type="text"></td>
            </tr>
            <tr>
                <td class="label">Эл. почта:</td>
                <td class="value"><input id="customer-email" type="email"></td>
            </tr>
            <tr>
                <td class="label">Способ доставки<span class="remark">*</span>:</td>
                <td class="value">
                    <p style="margin-top: 0px;">
                        <a href="#" class="tab-selected" id="self-link">Самовывоз</a>
                        <a href="#" class="tab-not-selected" id="delivery-link">Доставка курьером</a>
                    </p>
                    <div id="self-params">
                        <div>
                            <input type="radio" name="pick-point" value="elma" id="rb-pick-point-elma"> <a href="#" id="a-pick-point-elma">Завод Элма</a>
                            <div style="margin-left: 17px; margin-bottom: 10px; margin-top: 5px;"><span style="color: #787878;">Москва, Зеленоград, проезд 4922 (Озерная аллея), дом 4, стр. 5</span></div>
                        </div>
                        <div>
                            <input type="radio" name="pick-point" value="kontorshik" id="rb-pick-point-kontorshik"> <a href="#" id="a-pick-point-kontorshik">Магазин Конторщик</a>
                            <div style="margin-left: 17px; margin-bottom: 10px; margin-top: 5px;"><span style="color: #787878;">Москва, Зеленоград, корп. 514, 5ТЦ</span></div>
                        </div>
                        <div>
                            <input type="radio" name="pick-point" value="oktopole" id="rb-pick-point-oktopole"> <a href="#" id="a-pick-point-oktopole">Офис на Октябрьском поле</a>
                            <div style="margin-left: 17px; margin-bottom: 10px; margin-top: 5px;"><span style="color: #787878;">Москва, ул. Маршала Бирюзова, д. 4, к. 2, подъезд 3, офис 222</span></div>
                        </div>
                    </div>
                    <div id="delivery-params" style="display: none;">
                        <div>Адрес: <input id="customer-address" type="text" style="width: 600px;"></div>
                        <div style="margin-top: 10px;"><span class="remark">На данный момент доставка осуществляется только по городу Зеленоград</span></div>
                    </div>

                    <script type="text/javascript">
                        ['self', 'delivery'].forEach(function(s) {
                            $('#' + s + '-link').click(function(event) {
                                tab_toggle($(this).attr('id'))
                                event.preventDefault()
                            })
                        })

                        function tab_toggle(id) {
                            var clicked = id.substring(0, id.length - 5)
                            $('#' + id).attr('class', 'tab-selected')
                            $('#' + opposite(id) + '-link').attr('class', 'tab-not-selected')

                            $('#' + clicked + '-params').toggle()
                            $('#' + opposite(id) + '-params').toggle()

                            $('#pickyp-type').prop('value', clicked)

                            simpleCart({
                                 shippingFlatRate: (clicked == 'delivery' && simpleCart.total() < 3000 ? 150 : 0)
                            });

                            simpleCart.update()
                        }

                        function opposite(id) {
                            if (id.indexOf('self') == 0) {
                                return 'delivery'
                            }
                            return 'self'
                        }

                        ['elma', 'kontorshik', 'oktopole'].forEach(function(s) {
                            $('#a-pick-point-' + s).click(function(event) {
                                $('#rb-pick-point-' + s).prop('checked', true)
                                event.preventDefault()
                            })
                        })
                    </script>
                </td>
            </tr>
        </table>
        <input type="hidden" name="pickup-type" value="self" id="pickup-type">
        <a href="Самовывоз"></a>

        <a href="javascript:;" class="simpleCart_checkout">Оформить заказ</a>
    </div>
</div>